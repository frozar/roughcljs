(ns roughcljs.core-test
  (:require [roughcljs.core :as core]
            [cljs.test :refer (deftest is)]
            [com.rpl.specter :as sp]
            ))

(deftest rectangle_basic
  (is
   (=
    (core/rectangle 10 10 200 100)
    [:g
     {}
     [:path
      {:d
       "M8.200811698668558 8.872506429970484 C51.591798927324014 11.17447396190381, 90.08380640166504 10.94646225929439, 208.600394098201 8.871746260252577 M9.513421008951118 9.8669750794274 C79.06122362892054 11.48664507215347, 150.32955311576276 11.497707282252392, 209.94364362310682 9.34275898969243 M208.75692970864475 9.753965990617871 C210.46028067637235 42.863421361893415, 211.30103190708905 75.01769370399415, 211.7338342797011 111.91451545245945 M210.0837439680472 10.405081606470048 C209.8977821636945 37.85620547551662, 211.06250243075192 65.94524495583028, 210.84813792351633 110.46570605691522 M209.4326665387891 108.65536588923119 C147.35025198343035 110.44857161572357, 86.31042186345442 110.62436103732831, 10.769654336797196 111.0577715374683 M209.45642834245186 110.89446249378852 C163.16879751124034 111.30420559710473, 117.05909284853738 111.39397742447888, 10.515368335433712 110.263611720723 M8.95577116124332 108.02972437627614 C11.745224661193788 90.53481172770262, 11.618191010318696 69.7269279640168, 10.142602337524295 9.55743463523686 M9.525698401965201 110.9875612622127 C10.263142049312592 74.78604227397591, 9.805523067712784 40.423793877474964, 9.085183986462653 10.916210538707674",
       :style {:stroke "rgb(0, 0, 0)", :stroke-width "1", :fill "none"}}]])))

(deftest path_basic
  (is
   (=
    (core/path
     "M80 80 A 45 45, 0, 0, 0, 125 125 L 125 80 Z"
     {:rough-option {}})
    [:g
     {}
     [:path
      {:d
       "M78.00062938220799 80.38090856187046 M78.00062938220799 80.38090856187046 C76.8392036190768 94.36575706601752, 83.29404874868139 104.3432102908146, 90.85390080369362 110.68082087770665 M77.88947454467416 78.82574596628547 C79.09701458844815 90.15905959038673, 81.80020257481753 103.89455170852582, 90.44964640119397 113.91655781729708 M90.44964640119397 113.91655781729708 C102.09106415993723 120.51225320474916, 112.66337925614383 124.0828580410649, 123.15233560092749 124.39179237000644 M90.8999692843976 115.45245293951223 C100.57402906724441 120.71129382952788, 113.55337794962864 126.20979124647201, 123.99180555948989 123.44616213580593 M123.56721122981982 123.85327463177964 C123.67084884344182 109.45257419996838, 125.08211127294807 94.52211324253452, 124.95835424773395 81.71789236553013 M124.08887891424821 123.27406967477873 C124.86986976337393 109.26178432885376, 123.51974930147027 95.31898969958331, 124.32439989689738 80.1074231332168 M123.62776161544025 80.68093891628087 C115.22051050385701 79.16048674101829, 104.22228851720804 79.23048973349066, 77.69409218430519 79.5238285958767 M124.07665223721415 79.08014256414026 C110.7156207656045 79.72778558756164, 96.32049522498077 80.774817594401, 78.65129643213004 80.73007534909993",
       :style {:stroke "rgb(0, 0, 0)", :stroke-width "1", :fill "none"}}]]))
  (is
   (=
    ;; Transform the result to delete the generated id associate
    ;; which each filling pattern
    (->> (core/path
          "M80 80 A 45 45, 0, 0, 0, 125 125 L 125 80 Z"
          {:rough-option {:fill "black"}})
         (sp/transform
          [(sp/srange 1 2) sp/ALL (sp/srange 1 2) sp/ALL]
          (fn [hashmap]
            (dissoc hashmap :id)))
         (sp/transform
          [(sp/srange 2 3) sp/ALL (sp/srange 2 3) sp/ALL (sp/srange 1 2) sp/ALL :style]
          (fn [hashmap]
            (dissoc hashmap :fill)))
         )
    [:<>
     [:pattern
      {:x "0",
       :y "0",
       :width "1",
       :height "1",
       :viewBox "0 0 45 45",
       :patternUnits "objectBoundingBox"}
      [:path
       {:d
        "M0 0 C0 0, 0 0, 0 0 M0 0 C0 0, 0 0, 0 0 M-0.4415287926467011 6.943788438339822 C1.02099565141042 4.8293655237085575, 3.966857468589002 2.0117144249434364, 5.644098852904982 0.035083015620451574 M-0.0696414444269488 6.317974354003661 C1.8304540315657138 4.70577412093223, 3.0125390754260697 2.5566265162645543, 5.339974340754098 0.44075698031459387 M0.17608767683614368 11.308427150964318 C2.2284477738257653 7.138723252252508, 6.485699715908223 3.5142002601682556, 11.019765758466852 0.4115378509357335 M0.3900411442946301 12.656254839568913 C3.9636490470879107 7.288057804173655, 7.759763062940903 4.205928104041578, 11.1215598545493 0.5143498468294503 M0.5387498987326165 18.15667860293823 C6.914757258542209 12.138976297250096, 9.86320970957657 6.556923053239741, 13.752631147860964 0.296103733305352 M-0.2088956628507237 18.55777541352498 C4.938286089344694 12.813750976451182, 7.8017839269104385 8.029855463873133, 15.736607775560994 0.8318994414922765 M-1.2581064196117904 23.905376106216668 C8.440026355061933 14.69636784996864, 15.34811845900435 6.152722647868906, 21.15061051053729 -1.0828240593731877 M-0.06411044185987969 23.285218168697416 C7.864222716044428 15.49642410457, 15.376337355146097 6.110471920061009, 21.397970735372866 -0.7574110213503715 M1.6146904370327846 31.862581483785263 C4.7160371032688335 22.12011846712179, 13.622722403599239 15.446574603481267, 26.033855841171356 2.1918854167696775 M0.7773388717835203 30.06517533655112 C7.714767855006226 20.92434039597166, 15.768655522385684 11.897425603760492, 26.118210922602923 0.0960211999726237 M-0.8238244281244 37.491663768702495 C11.671726698726511 25.096161932665296, 22.996759570458018 11.167474681950882, 32.66925814696292 -1.5441552604303475 M0.38426155121061 37.0099722489727 C12.683349891016354 24.077826741797537, 23.749776426420222 9.334063347000896, 31.279423201872802 -0.266789705374908 M-1.1346940368740803 41.30482011902683 C8.769478251621992 35.31390063487087, 15.742115674587234 26.150356719051665, 37.80689419414972 1.4248329327535352 M-0.5563690679474718 41.62939517534875 C8.57527269731699 31.988566999052125, 17.104640846412025 23.19213387012198, 35.91388038434212 -0.24478028983804379 M3.7284604639929952 45.67557581781676 C19.231460854901712 29.45932916276686, 31.558833762572043 9.978824629225329, 44.11599873993151 -1.030381175842976 M2.6668344124404015 45.924441322565876 C12.708309082393615 34.13328853234664, 22.433664471816442 23.414280623170185, 42.358755459632505 -0.9207644892529601 M6.575116889657604 47.38715553246244 C21.66326939231455 31.652607247701955, 32.31187649382246 16.17169699828515, 48.46793327155554 0.7208472677296882 M7.164100539976882 46.21694009434237 C17.40573325361193 34.13805689797173, 26.760756411296146 22.85116485227438, 47.75784033491307 1.8247025991580372 M10.98052561140495 45.01091743780452 C19.527655889092866 39.23696372631544, 29.482687192587825 27.170889737638237, 48.09186309328801 6.617410402866646 M12.66592260586905 46.80923721434701 C23.870299443186333 33.5086665361482, 34.49475113679583 19.981674169894276, 46.43597292187191 7.142945976118192 M15.938331107444288 47.379371191901484 C28.720029526428988 34.79215917677057, 40.65885468206587 21.81430460965096, 47.947083732281214 13.153013531289735 M18.394430195748033 47.738462701966384 C27.923300262646155 35.41206752832621, 38.08867430116459 21.891297826730966, 46.490113542583174 13.744986617177466 M24.799599730984873 48.43635457781181 C32.81920602957044 35.583904963728436, 38.314381925194155 26.93531623383108, 45.10145841674442 17.77344756105743 M23.221166957744963 45.907957514087116 C31.087994395139262 36.053224459414, 40.39697943281759 26.830320275820092, 46.38653240767802 19.58006391672246 M27.49214262326445 48.31366224426229 C34.86407047119331 37.82601264891183, 39.755662035983285 32.8139390143049, 44.88709516291537 25.424960265896534 M28.105163515519457 47.44515228576411 C34.03553747562778 41.45598060302405, 39.15701007327417 34.85602176518862, 46.335236703316056 26.665256947308098 M35.300428916482765 44.86057864408864 C38.59564776424557 39.28423511625038, 44.65381313530185 35.957809528722535, 45.680259977993806 30.083789223642754 M34.09160067119314 47.512350268661216 C38.81177831153622 41.326679873269654, 43.85636600877518 34.2075667503141, 47.2886337941189 31.896267398098217 M39.37156191051105 46.66068782227385 C40.40762956465224 44.05323095078908, 43.28522825051499 41.52227305871477, 47.34211992546943 37.70545210640768 M39.17054611343989 46.62714740036326 C41.216796822670815 44.12871454503127, 42.717812874236 41.94416152303144, 46.89746254328666 38.04895676158259",
        :style {:stroke "black", :stroke-width "0.5", :fill "none"}}]]
     [:g
      {}
      [:path
       {:d "M80 80 A 45 45, 0, 0, 0, 125 125 L 125 80 Z",
        :style
        {:stroke "none",
         :stroke-width "0"}}]
      [:path
       {:d
        "M78.00062938220799 80.38090856187046 M78.00062938220799 80.38090856187046 C76.8392036190768 94.36575706601752, 83.29404874868139 104.3432102908146, 90.85390080369362 110.68082087770665 M77.88947454467416 78.82574596628547 C79.09701458844815 90.15905959038673, 81.80020257481753 103.89455170852582, 90.44964640119397 113.91655781729708 M90.44964640119397 113.91655781729708 C102.09106415993723 120.51225320474916, 112.66337925614383 124.0828580410649, 123.15233560092749 124.39179237000644 M90.8999692843976 115.45245293951223 C100.57402906724441 120.71129382952788, 113.55337794962864 126.20979124647201, 123.99180555948989 123.44616213580593 M123.56721122981982 123.85327463177964 C123.67084884344182 109.45257419996838, 125.08211127294807 94.52211324253452, 124.95835424773395 81.71789236553013 M124.08887891424821 123.27406967477873 C124.86986976337393 109.26178432885376, 123.51974930147027 95.31898969958331, 124.32439989689738 80.1074231332168 M123.62776161544025 80.68093891628087 C115.22051050385701 79.16048674101829, 104.22228851720804 79.23048973349066, 77.69409218430519 79.5238285958767 M124.07665223721415 79.08014256414026 C110.7156207656045 79.72778558756164, 96.32049522498077 80.774817594401, 78.65129643213004 80.73007534909993",
        :style {:stroke "rgb(0, 0, 0)", :stroke-width "1", :fill "none"}}]]])))
